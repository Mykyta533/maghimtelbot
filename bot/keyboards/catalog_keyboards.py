from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton

def get_categories_keyboard(categories):
    """–ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π —Ç–æ–≤–∞—Ä—ñ–≤"""
    keyboard = []

    for category in categories:
        keyboard.append([
            InlineKeyboardButton(
                text=category['name'],
                callback_data=f"category_{category['id']}"
            )
        ])

    keyboard.append([
        InlineKeyboardButton(text="üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é", callback_data="back_to_menu")
    ])

    return InlineKeyboardMarkup(inline_keyboard=keyboard)


def get_product_keyboard(product_id, current_index=0, total_products=1, category_id=None):
    """–ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –¥–ª—è —Ç–æ–≤–∞—Ä—É"""
    keyboard = []

    # –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –º—ñ–∂ —Ç–æ–≤–∞—Ä–∞–º–∏ (—è–∫—â–æ —Ç–æ–≤–∞—Ä—ñ–≤ –±—ñ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ)
    if total_products > 1 and category_id is not None:
        nav_buttons = []
        if current_index > 0:
            nav_buttons.append(
                InlineKeyboardButton(text="‚¨ÖÔ∏è", callback_data=f"nav_{category_id}_{current_index - 1}")
            )

        nav_buttons.append(
            InlineKeyboardButton(
                text=f"{current_index + 1}/{total_products}",
                callback_data="current_product"
            )
        )

        if current_index < total_products - 1:
            nav_buttons.append(
                InlineKeyboardButton(text="‚û°Ô∏è", callback_data=f"nav_{category_id}_{current_index + 1}")
            )

        keyboard.append(nav_buttons)

    # –û—Å–Ω–æ–≤–Ω—ñ –∫–Ω–æ–ø–∫–∏
    keyboard.extend([
        [
            InlineKeyboardButton(
                text="üõí –î–æ–¥–∞—Ç–∏ –¥–æ –∫–æ—à–∏–∫–∞",
                callback_data=f"add_cart_{product_id}"
            )
        ],
        [
            InlineKeyboardButton(
                text="üßæ –ó–∞–º–æ–≤–∏—Ç–∏ –∑–∞—Ä–∞–∑",
                callback_data=f"order_{product_id}"
            )
        ]
    ])

    # –ö–Ω–æ–ø–∫–∞ "–î–æ –∫–∞—Ç–∞–ª–æ–≥—É" –∑ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è–º –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
    back_callback = f"category_{category_id}" if category_id else "back_to_catalog"
    keyboard.append([
        InlineKeyboardButton(text="üîô –î–æ –∫–∞—Ç–∞–ª–æ–≥—É", callback_data=back_callback)
    ])

    return InlineKeyboardMarkup(inline_keyboard=keyboard)
